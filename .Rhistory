#rm(dataMapValues)
#rm(strataAreas)
##############################
## CEO labels, 2015 - 2020
##############################
colnames(FINALDATASET)
unique(FINALDATASET$DISTURBANCE)
table(FINALDATASET$DISTURBANCE)
unique(FINALDATASET$DISTTYPE)
table(FINALDATASET$DISTTYPE)
## fill records with empty disturbance type with the stable label from disturbance column
FINALDATASET$DISTTYPE[FINALDATASET$DISTTYPE==""]<-FINALDATASET$DISTURBANCE[FINALDATASET$DISTTYPE==""]
#write.csv(FINALDATASET, file = 'Results\\FINALDATASET_beforeemptyanswersremoved.csv', row.names = F)
unique(FINALDATASET$DISTTYPE)
table(FINALDATASET$DISTTYPE)
## remove empty data row
FINALDATASET<-FINALDATASET[FINALDATASET$DISTTYPE!="",]
nrow(FINALDATASET)
write.csv(FINALDATASET, file = 'Results\\FINALDATASET_JUSTBEFOREANALYSIS.csv', row.names = F)
#################Get ready to calculate agreement for each map with CEO data#######################
####Make map labels readable
#Landtrendr
FINALDATASET$LTreadable <- ifelse(FINALDATASET$LTstrata == 1, 'No - Stable Forest',
ifelse(FINALDATASET$LTstrata == 2, 'Degradation',
ifelse(FINALDATASET$LTstrata == 3, 'Deforestation (loss)',
ifelse(FINALDATASET$LTstrata == 4, 'No - Stable Non Forest','NotReviewed'))))
table(FINALDATASET$LTreadable)
#Machine Learning
FINALDATASET$MLreadable <- ifelse(FINALDATASET$MLstrata == 1, 'No - Stable Forest',
ifelse(FINALDATASET$MLstrata == 2, 'Degradation',
ifelse(FINALDATASET$MLstrata == 3, 'Deforestation (loss)',
ifelse(FINALDATASET$MLstrata == 4, 'No - Stable Non Forest','NotReviewed'))))
table(FINALDATASET$MLreadable)
#CODED
FINALDATASET$CODEDreadable <- ifelse(FINALDATASET$codedstrata == 1, 'No - Stable Forest',
ifelse(FINALDATASET$codedstrata == 2, 'No - Stable Non Forest',
ifelse(FINALDATASET$codedstrata == 3, 'Degradation',
ifelse(FINALDATASET$codedstrata == 4, 'Deforestation (loss)','NotReviewed'))))
table(FINALDATASET$CODEDreadable)
#CCDC-SMA Readable
FINALDATASET$CSreadable <- ifelse(FINALDATASET$CSstrata == 1, 'Degradation',
ifelse(FINALDATASET$CSstrata == 2, 'Deforestation (loss)',
ifelse(FINALDATASET$CSstrata == 3, 'No - Stable Forest',
ifelse(FINALDATASET$CSstrata == 4, 'No - Stable Non Forest','NotReviewed'))))
table(FINALDATASET$CSreadable)
#Stacked Combo
#2MATCHDEG:1
#3MATCHDEG:2
#2MATCHLOSS:3
#3MATCHLOSS:4
#1DEG:5
#1LOSS:6
#1DEG1LOSS:7
#nonforest:8
#stable forest:9
FINALDATASET$STACKEDreadable <- ifelse(FINALDATASET$ChangeStrata == 9, 'No - Stable Forest',
ifelse(FINALDATASET$ChangeStrata == 8, 'No - Stable Non Forest',
ifelse(FINALDATASET$ChangeStrata == 1 | FINALDATASET$ChangeStrata == 2 | FINALDATASET$ChangeStrata == 5, 'Degradation',
ifelse(FINALDATASET$ChangeStrata == 3 | FINALDATASET$ChangeStrata == 4 | FINALDATASET$ChangeStrata == 6, 'Deforestation (loss)',
ifelse(FINALDATASET$ChangeStrata == 7, 'more than one type','NotReviewed')))))
table(FINALDATASET$STACKEDreadable)
#STACKED V2 Medium Likelihood
FINALDATASET$STACKEDreadable_likely <- ifelse(FINALDATASET$ChangeStrata == 9, 'No - Stable Forest',
ifelse(FINALDATASET$ChangeStrata == 8, 'No - Stable Non Forest',
ifelse(FINALDATASET$ChangeStrata == 1 | FINALDATASET$ChangeStrata == 2, 'Likely Degradation (2)',
ifelse(FINALDATASET$ChangeStrata == 3 | FINALDATASET$ChangeStrata == 4, 'Likely Deforestation (loss) (2)',
ifelse(FINALDATASET$ChangeStrata == 5, 'Unlikely Degradation (1)',
ifelse(FINALDATASET$ChangeStrata == 6, 'Unlikely Deforestation (1)',
ifelse(FINALDATASET$ChangeStrata == 7, 'more than one type','NotReviewed')))))))
table(FINALDATASET$STACKEDreadable_likely)
#STACKED V3 High Likelihood
FINALDATASET$STACKEDreadable_verylikely <- ifelse(FINALDATASET$ChangeStrata == 9, 'No - Stable Forest',
ifelse(FINALDATASET$ChangeStrata == 8, 'No - Stable Non Forest',
ifelse(FINALDATASET$ChangeStrata == 2, 'Likely Degradation (3)',
ifelse(FINALDATASET$ChangeStrata == 4, 'Likely Deforestation (loss) (3)',
ifelse(FINALDATASET$ChangeStrata ==5 | FINALDATASET$ChangeStrata == 1, 'Unlikely Degradation (1-2)',
ifelse(FINALDATASET$ChangeStrata == 3 | FINALDATASET$ChangeStrata == 6, 'Unlikely Deforestation (1-2)',
ifelse(FINALDATASET$ChangeStrata == 7, 'more than one type','NotReviewed')))))))
table(FINALDATASET$STACKEDreadable_verylikely)
table(FINALDATASET$STACKEDreadable_verylikely,)
Verylikely <-table(FINALDATASET$STACKEDreadable_verylikely)
write.csv(Verylikely, file = 'Results\\VeryLikely_3mapsagree_CEOcompare_SAVE.csv', row.names = T)
#make the agreement tables
#LandTrendr
FINALDATASET$LTcompare <- ifelse(FINALDATASET$DISTTYPE == FINALDATASET$LTreadable, 'Agree',
ifelse(FINALDATASET$DISTTYPE != FINALDATASET$LTreadable & FINALDATASET$DISTTYPE != 'NA', 'Dis','NotReviewed'))
table(FINALDATASET$LTcompare)
SMEagreement_LandTrendr <- table(FINALDATASET$LTcompare)
#Machine Learning
FINALDATASET$MLcompare <- ifelse(FINALDATASET$DISTTYPE == FINALDATASET$MLreadable, 'Agree',
ifelse(FINALDATASET$DISTTYPE != FINALDATASET$MLreadable & FINALDATASET$DISTTYPE != 'NA', 'Dis','NotReviewed'))
table(FINALDATASET$MLcompare)
SMEagreement_MachineLearning <- table(FINALDATASET$MLcompare)
#CODED
FINALDATASET$CODEDcompare <- ifelse(FINALDATASET$DISTTYPE == FINALDATASET$CODEDreadable, 'Agree',
ifelse(FINALDATASET$DISTTYPE != FINALDATASET$CODEDreadable & FINALDATASET$DISTTYPE != 'NA', 'Dis','NotReviewed'))
table(FINALDATASET$CODEDcompare)
SMEagreement_CODED <- table(FINALDATASET$CODEDcompare)
#CCDC-SMA
FINALDATASET$CScompare <- ifelse(FINALDATASET$DISTTYPE == FINALDATASET$CSreadable, 'Agree',
ifelse(FINALDATASET$DISTTYPE != FINALDATASET$CSreadable & FINALDATASET$DISTTYPE != 'NA', 'Dis','NotReviewed'))
table(FINALDATASET$CScompare)
SMEagreement_CCDCSMA <- table(FINALDATASET$CScompare)
#STACKED combo
FINALDATASET$STACKEDcompare <- ifelse(FINALDATASET$DISTTYPE == FINALDATASET$STACKEDreadable, 'Agree',
ifelse(FINALDATASET$DISTTYPE != FINALDATASET$STACKEDreadable & FINALDATASET$DISTTYPE != 'NA', 'Dis','NotReviewed'))
table(FINALDATASET$STACKEDcompare)
table(FINALDATASET$DISTTYPE, FINALDATASET$STACKEDreadable)
agreement_STACKED <- table(FINALDATASET$STACKEDcompare)
write.csv(FINALDATASET, file = 'Results\\FINALDATASET_checkingthings.csv', row.names = F)
##############################################################################
#################################################################################
######## Analysis #####################################################################
#################################################################################
##############################################################################
################
## Cross tabulations
################
colnames(FINALDATASET)
head(FINALDATASET)
# counts of answers
table(FINALDATASET$DISTURBANCE)
table(FINALDATASET$DISTTYPE)
table(FINALDATASET$strata)
#################################
## agreement matrix
#################################
#cross tab of strata by disturbance type
table(FINALDATASET$strata, FINALDATASET$DISTTYPE)
table_strata_CEODISTTYPE <- table(FINALDATASET$strata, FINALDATASET$DISTTYPE)
write.csv(table_strata_CEODISTTYPE, file = 'Results\\crosstable_strata_CEODISTTYPE.csv', row.names = T)
#create a column that has reclassified map labels to match simplified CEO
unique(FINALDATASET$DISTTYPE)
unique(FINALDATASET$strata)
FINALDATASET$SimpleMapClass<-"fixMe"
FINALDATASET$SimpleMapClass[FINALDATASET$strata == "stable forest"]<-"SF"
FINALDATASET$SimpleMapClass[FINALDATASET$strata == "nonforest "]<-"SNF"
FINALDATASET$SimpleMapClass[FINALDATASET$strata == "1LOSS" |
FINALDATASET$strata == "2MATCHLOSS" |
FINALDATASET$strata == "3MATCHLOSS"]<-"Deforestation"
FINALDATASET$SimpleMapClass[FINALDATASET$strata == "1DEG" |
FINALDATASET$strata == "2MATCHDEG" |
FINALDATASET$strata == "3MATCHDEG"]<-"Degradation"
FINALDATASET$SimpleMapClass[FINALDATASET$strata == "1DEG1LOSS"]<-"multi-disturbance"
#create a column that has simplified CEO
unique(FINALDATASET$DISTTYPE)
unique(FINALDATASET$strata)
######CEO strata should stay the same as the strata design originals for area estimation
#######this is only for easy viewing
FINALDATASET$SimpleCEOClass<-"fixMe"
FINALDATASET$SimpleCEOClass[FINALDATASET$DISTTYPE == "No - Stable Forest"]<-"SF"
FINALDATASET$SimpleCEOClass[FINALDATASET$DISTTYPE == "No - Stable Non Forest"]<-"SNF"
FINALDATASET$SimpleCEOClass[FINALDATASET$DISTTYPE == "Deforestation (loss)"] <-"Deforestation"
FINALDATASET$SimpleCEOClass[FINALDATASET$DISTTYPE == "Degradation"]<-"Degradation"
FINALDATASET$SimpleCEOClass[FINALDATASET$DISTTYPE == "more than one type"]<-"multi-disturbance"
FINALDATASET$SimpleCEOClass[FINALDATASET$DISTTYPE == "Reforestation"]<-"Reforestation"
table(FINALDATASET$DISTTYPE)
table(FINALDATASET$strata)
table(FINALDATASET$SimpleMapClass)
table(FINALDATASET$SimpleCEOClass)
write.csv(FINALDATASET, file = 'Results\\FINALDATASET_quickcheck.csv', row.names = T)
#agreement<-table(dataCEO_combo$strata, dataCEO_combo$distType)
agreement<-table(FINALDATASET$SimpleMapClass, FINALDATASET$SimpleCEOClass)
names(dimnames(agreement)) <- c('Map','CEO')
agreement
write.csv(agreement, file = 'Results\\Agreements_INCLUDINGQAQC_SAVE_3maps.csv', row.names = T)
agreement<-table(FINALDATASET$strata, FINALDATASET$SimpleCEOClass)
names(dimnames(agreement)) <- c('Map','CEO')
agreement
write.csv(agreement, file = 'Results\\Agreements_INCLUDINGQAQC_SAVE_3maps_origstrata.csv', row.names = T)
##################################
##Compare tables
LT_Compare_Table <- table(FINALDATASET$LTreadable, FINALDATASET$SimpleCEOClass)
write.csv(SMEagreement_LandTrendr, file = 'Results\\CEO_LandTrendr_agreement_rates_SAVE.csv', row.names = T)
write.csv(LT_Compare_Table, file = 'Results\\LT_Compare_Table_SAVE.csv', row.names = T)
ML_Compare_Table <- table(FINALDATASET$MLreadable, FINALDATASET$SimpleCEOClass)
write.csv(SMEagreement_MachineLearning, file = 'Results\\CEO_MachineLearning_agreement_rates_SAVE.csv', row.names = T)
write.csv(ML_Compare_Table, file = 'Results\\ML_Compare_Table_SAVE.csv', row.names = T)
CODED_Compare_Table <- table(FINALDATASET$CODEDreadable, FINALDATASET$SimpleCEOClass)
write.csv(SMEagreement_CODED, file = 'Results\\CEO_CODED_agreement_rates_SAVE.csv', row.names = T)
write.csv(CODED_Compare_Table, file = 'Results\\CODED_Compare_Table_SAVE.csv', row.names = T)
CCDCSMA_Compare_Table <- table(FINALDATASET$CSreadable, FINALDATASET$SimpleCEOClass)
write.csv(SMEagreement_CCDCSMA, file = 'Results\\CEO_CCDCSMA_agreement_rates_SAVE.csv', row.names = T)
write.csv(CCDCSMA_Compare_Table, file = 'Results\\CCDCSMA_Compare_Table_SAVE.csv', row.names = T)
STACKED_Compare_Table <- table(FINALDATASET$STACKEDreadable, FINALDATASET$SimpleCEOClass)
write.csv(agreement_STACKED, file = 'Results\\CEO_STACKED_agreement_rates_SAVE.csv', row.names = T)
write.csv(STACKED_Compare_Table, file = 'Results\\STACKED_Compare_Table_SAVE.csv', row.names = T)
##Compare tables
LT_Compare_Table <- table(FINALDATASET$LTreadable, FINALDATASET$SimpleCEOClass)
write.csv(SMEagreement_LandTrendr, file = 'Results\\CEO_LandTrendr_agreement_rates_SAVE.csv', row.names = T)
write.csv(LT_Compare_Table, file = 'Results\\LT_Compare_Table_SAVE.csv', row.names = T)
ML_Compare_Table <- table(FINALDATASET$MLreadable, FINALDATASET$SimpleCEOClass)
write.csv(SMEagreement_MachineLearning, file = 'Results\\CEO_MachineLearning_agreement_rates_SAVE.csv', row.names = T)
write.csv(ML_Compare_Table, file = 'Results\\ML_Compare_Table_SAVE.csv', row.names = T)
CODED_Compare_Table <- table(FINALDATASET$CODEDreadable, FINALDATASET$SimpleCEOClass)
write.csv(SMEagreement_CODED, file = 'Results\\CEO_CODED_agreement_rates_SAVE.csv', row.names = T)
write.csv(CODED_Compare_Table, file = 'Results\\CODED_Compare_Table_SAVE.csv', row.names = T)
CCDCSMA_Compare_Table <- table(FINALDATASET$CSreadable, FINALDATASET$SimpleCEOClass)
write.csv(SMEagreement_CCDCSMA, file = 'Results\\CEO_CCDCSMA_agreement_rates_SAVE.csv', row.names = T)
write.csv(CCDCSMA_Compare_Table, file = 'Results\\CCDCSMA_Compare_Table_SAVE.csv', row.names = T)
STACKED_Compare_Table <- table(FINALDATASET$STACKEDreadable, FINALDATASET$SimpleCEOClass)
write.csv(agreement_STACKED, file = 'Results\\CEO_STACKED_agreement_rates_SAVE.csv', row.names = T)
write.csv(STACKED_Compare_Table, file = 'Results\\STACKED_Compare_Table_SAVE.csv', row.names = T)
#Make a bar chart
#Crystal Wespestad (SIG) March, 2022
#####################################################################
library(survey)
library(tidyverse)
library(knitr)
library(rmarkdown)
library(tidyr)
library(networkD3)
library(tidyverse)
library(dplyr)
library(scales)
library(lubridate)
setwd("C:\\Users\\cryst\\OneDrive\\Documents\\Philippines\\PhilippinesQAQCanalysis")
# area csv
#dataarea_NEW <- read.csv('Results\\AreasofDisturbance_ceoV4version_SAVE_NEW.csv') #R results
dataarea_NEW <- read.csv('Results\\AreasofDisturbance_ceoV4version_SAVE_NEW_OlafssonWay.csv')
# area csv
#dataarea_NEW <- read.csv('Results\\AreasofDisturbance_ceoV4version_SAVE_NEW.csv') #R results
dataarea_NEW <- read.csv('Results\\AreasofDisturbance_ceoV4version_SAVE_NEW_OlafssonWay.csv')
dataarea_NEW$phase<-'review'
dataarea_NEW
# area csv
#dataarea_old <- read.csv('Results\\AreasofDisturbance_ceoV4version_SAVE_Old.csv') #R results
dataarea_old <- read.csv('Results\\AreasofDisturbance_ceoV4version_SAVE_OLD_OlafssonWay.csv')
dataarea_old$phase<-'initial'
colnames(dataarea_old)[1]<-"Strata"
dataarea_old
?comma_format()
#type.convert(dataarea_NEW$Area, as.is=TRUE)   ###kinda helped
dataTest <- rbind(dataarea_NEW, dataarea_old)
dataTest$Arealab <- comma_format()(dataTest$Area)
dataTest$SElab <- paste0('+/- ', comma_format()(dataTest$SE))
data <- data.frame(dataTest)
# Calculate y position, placing it in the middle
####BELOW GETS LOTS OF ERRORS####
data <- data %>%
group_by(Strata) %>%
#mutate(label_y = cumsum(Area) - 0.5 * Area)
mutate(label_y = cumsum(Area) -cumsum(Area))
# Calculate error position, placing it above
data <- data %>%
group_by(Strata) %>%
mutate(label_error = SE+Area)
# Most basic error bar
ggplot(data, aes(fill= phase, x = Strata, y = Area )) +
geom_bar(position="dodge", stat="identity", alpha=1) +
geom_errorbar(aes(ymin = Area - SE, ymax = Area + SE),
width = 0.2, colour = "black",
position = position_dodge(.9)) +
geom_text(aes(label = Arealab, y = label_error), position = position_dodge(.9),
vjust = -2.5, colour = "black", size=3)+
geom_text(aes(label = SElab, y = label_error), position = position_dodge(.9),
vjust = -1, colour="black", size=3) +
xlab('LU activities') + # for the x axis label
ylab('Area, ha') + scale_y_continuous(labels = comma)
# Most basic error bar
ggplot(data, aes(fill= phase, x = Strata, y = Area )) +
geom_bar(position="dodge", stat="identity", alpha=1) +
geom_errorbar(aes(ymin = Area - SE, ymax = Area + SE),
width = 0.2, colour = "black",
position = position_dodge(.9)) +
geom_text(aes(label = Arealab, y = label_error), position = position_dodge(.5),
vjust = -2.5, colour = "black", size=3)+
geom_text(aes(label = SElab, y = label_error), position = position_dodge(.9),
vjust = -1, colour="black", size=3) +
xlab('LU activities') + # for the x axis label
ylab('Area, ha') + scale_y_continuous(labels = comma)
# Most basic error bar
ggplot(data, aes(fill= phase, x = Strata, y = Area )) +
geom_bar(position="dodge", stat="identity", alpha=1) +
geom_errorbar(aes(ymin = Area - SE, ymax = Area + SE),
width = 0.2, colour = "black",
position = position_dodge(.9)) +
geom_text(aes(label = Arealab, y = label_error), position = position_dodge(.9),
vjust = -2.5, colour = "black", size=3)+
geom_text(aes(label = SElab, y = label_error), position = position_dodge(.9),
vjust = -0.5, colour="black", size=3) +
xlab('LU activities') + # for the x axis label
ylab('Area, ha') + scale_y_continuous(labels = comma)
# Most basic error bar
ggplot(data, aes(fill= phase, x = Strata, y = Area )) +
geom_bar(position="dodge", stat="identity", alpha=1) +
geom_errorbar(aes(ymin = Area - SE, ymax = Area + SE),
width = 0.2, colour = "black",
position = position_dodge(.9)) +
geom_text(aes(label = Arealab, y = label_error), position = position_dodge(.9),
vjust = -1.5, colour = "black", size=3)+
geom_text(aes(label = SElab, y = label_error), position = position_dodge(.9),
vjust = -0.5, colour="black", size=3) +
xlab('LU activities') + # for the x axis label
ylab('Area, ha') + scale_y_continuous(labels = comma)
# Most basic error bar
ggplot(data, aes(fill= phase, x = Strata, y = Area )) +
geom_bar(position="dodge", stat="identity", alpha=1) +
geom_errorbar(aes(ymin = Area - SE, ymax = Area + SE),
width = 0.2, colour = "black",
position = position_dodge(.9)) +
geom_text(aes(label = Arealab, y = label_error), position = position_dodge(.9),
vjust = -1.3, colour = "black", size=3)+
geom_text(aes(label = SElab, y = label_error), position = position_dodge(.9),
vjust = -0.3, colour="black", size=3) +
xlab('LU activities') + # for the x axis label
ylab('Area, ha') + scale_y_continuous(labels = comma)
# Most basic error bar
ggplot(data, aes(fill= phase, x = Strata, y = Area )) +
geom_bar(position="dodge", stat="identity", alpha=1) +
geom_errorbar(aes(ymin = Area - SE, ymax = Area + SE),
width = 0.2, colour = "black",
position = position_dodge(.9)) +
geom_text(aes(label = Arealab, y = label_error), position = position_dodge(.9),
vjust = -1.3, colour = "black", size=3)+
geom_text(aes(label = SElab, y = label_error), position = position_dodge(.9),
vjust = -0.2, colour="black", size=3) +
xlab('LU activities') + # for the x axis label
ylab('Area, ha') + scale_y_continuous(labels = comma)
# Most basic error bar
ggplot(data, aes(fill= phase, x = Strata, y = Area )) +
geom_bar(position="dodge", stat="identity", alpha=1) +
geom_errorbar(aes(ymin = Area - SE, ymax = Area + SE),
width = 0.2, colour = "black",
position = position_dodge(.9)) +
geom_text(aes(label = Arealab, y = label_error), position = position_dodge(.9),
vjust = -1.3, colour = "black", size=3)+
geom_text(aes(label = SElab, y = label_error), position = position_dodge(.9),
vjust = -0.2, colour="black", size=2.5) +
xlab('LU activities') + # for the x axis label
ylab('Area, ha') + scale_y_continuous(labels = comma)
#Make a bar chart
#Crystal Wespestad (SIG) March, 2022
#####################################################################
library(survey)
library(tidyverse)
library(knitr)
library(rmarkdown)
library(tidyr)
library(networkD3)
library(tidyverse)
library(dplyr)
library(scales)
library(lubridate)
setwd("C:\\Users\\cryst\\OneDrive\\Documents\\Philippines\\PhilippinesQAQCanalysis")
# area csv
#dataarea_NEW <- read.csv('Results\\AreasofDisturbance_ceoV4version_SAVE_NEW.csv') #R results
dataarea_NEW <- read.csv('Results\\AreasofDisturbance_ceoV4version_SAVE_NEW_OlafssonWay.csv')
dataarea_NEW$phase<-'review'
dataarea_NEW
# area csv
#dataarea_old <- read.csv('Results\\AreasofDisturbance_ceoV4version_SAVE_Old.csv') #R results
dataarea_old <- read.csv('Results\\AreasofDisturbance_ceoV4version_SAVE_OLD_OlafssonWay.csv')
dataarea_old$phase<-'initial'
colnames(dataarea_old)[1]<-"Strata"
dataarea_old
?comma_format()
#type.convert(dataarea_NEW$Area, as.is=TRUE)   ###kinda helped
dataTest <- rbind(dataarea_NEW, dataarea_old)
dataTest$Arealab <- comma_format()(dataTest$Area)
#dataTest$Arealab <- 1
dataTest$SElab <- paste0('+/- ', comma_format()(dataTest$SE))
###above got error: Error in x * scale : non-numeric argument to binary operator
data <- data.frame(dataTest)
#vLABELH <- c(145813,152997,90409,160376,286795,355990,346318)
# Calculate y position, placing it in the middle
####BELOW GETS LOTS OF ERRORS####
data <- data %>%
group_by(Strata) %>%
#mutate(label_y = cumsum(Area) - 0.5 * Area)
mutate(label_y = cumsum(Area) -cumsum(Area))
# Calculate error position, placing it above
data <- data %>%
group_by(Strata) %>%
mutate(label_error = SE+Area)
# Most basic error bar
ggplot(data, aes(fill= phase, x = Strata, y = Area )) +
geom_bar(position="dodge", stat="identity", alpha=1) +
geom_errorbar(aes(ymin = Area - SE, ymax = Area + SE),
width = 0.2, colour = "black",
position = position_dodge(.9)) +
geom_text(aes(label = Arealab, y = label_error), position = position_dodge(.9),
vjust = -1.3, colour = "black", size=3)+
geom_text(aes(label = SElab, y = label_error), position = position_dodge(.9),
vjust = -0.2, colour="black", size=2.5) +
xlab('LU activities') + # for the x axis label
ylab('Area, ha') + scale_y_continuous(labels = comma)
# Most basic error bar
ggplot(data, aes(fill= phase, x = Strata, y = Area )) +
geom_bar(position="dodge", stat="identity", alpha=1) +
geom_errorbar(aes(ymin = Area - SE, ymax = Area + SE),
width = 0.2, colour = "black",
position = position_dodge(.9)) +
geom_text(aes(label = Arealab, y = label_error), position = position_dodge(.9),
vjust = -1.3, colour = "black", size=3)+
geom_text(aes(label = SElab, y = label_error), position = position_dodge(.9),
vjust = -0.25, colour="black", size=2.5) +
xlab('LU activities') + # for the x axis label
ylab('Area, ha') + scale_y_continuous(labels = comma)
# Most basic error bar
ggplot(data, aes(fill= phase, x = Strata, y = Area )) +
geom_bar(position="dodge", stat="identity", alpha=1) +
geom_errorbar(aes(ymin = Area - SE, ymax = Area + SE),
width = 0.2, colour = "black",
position = position_dodge(.9)) +
geom_text(aes(label = Arealab, y = label_error), position = position_dodge(.9),
vjust = -1.3, colour = "black", size=2.8)+
geom_text(aes(label = SElab, y = label_error), position = position_dodge(.9),
vjust = -0.25, colour="black", size=2.5) +
xlab('LU activities') + # for the x axis label
ylab('Area, ha') + scale_y_continuous(labels = comma)
# Most basic error bar
ggplot(data, aes(fill= phase, x = Strata, y = Area )) +
geom_bar(position="dodge", stat="identity", alpha=1) +
geom_errorbar(aes(ymin = Area - SE, ymax = Area + SE),
width = 0.2, colour = "black",
position = position_dodge(.9)) +
geom_text(aes(label = Arealab, y = label_error), position = position_dodge(.9),
vjust = -1.4, colour = "black", size=2.8)+
geom_text(aes(label = SElab, y = label_error), position = position_dodge(.9),
vjust = -0.25, colour="black", size=2.5) +
xlab('LU activities') + # for the x axis label
ylab('Area, ha') + scale_y_continuous(labels = comma)
# Most basic error bar
ggplot(data, aes(fill= phase, x = Strata, y = Area )) +
geom_bar(position="dodge", stat="identity", alpha=1) +
geom_errorbar(aes(ymin = Area - SE, ymax = Area + SE),
width = 0.2, colour = "black",
position = position_dodge(.9)) +
geom_text(aes(label = Arealab, y = label_error), position = position_dodge(.9),
vjust = -1.4, colour = "black", size=2.8)+
geom_text(aes(label = SElab, y = label_error), position = position_dodge(.9),
vjust = -0.3, colour="black", size=2.5) +
xlab('LU activities') + # for the x axis label
ylab('Area, ha') + scale_y_continuous(labels = comma)
# Most basic error bar
ggplot(data, aes(fill= phase, x = Strata, y = Area )) +
geom_bar(position="dodge", stat="identity", alpha=1) +
geom_errorbar(aes(ymin = Area - SE, ymax = Area + SE),
width = 0.2, colour = "black",
position = position_dodge(.9)) +
geom_text(aes(label = Arealab, y = label_error), position = position_dodge(.9),
vjust = -1.45, colour = "black", size=2.8)+
geom_text(aes(label = SElab, y = label_error), position = position_dodge(.9),
vjust = -0.3, colour="black", size=2.5) +
xlab('LU activities') + # for the x axis label
ylab('Area, ha') + scale_y_continuous(labels = comma)
# Most basic error bar
ggplot(data, aes(fill= phase, x = Strata, y = Area )) +
geom_bar(position="dodge", stat="identity", alpha=1) +
geom_errorbar(aes(ymin = Area - SE, ymax = Area + SE),
width = 0.2, colour = "black",
position = position_dodge(.9)) +
geom_text(aes(label = Arealab, y = label_error), position = position_dodge(.9),
vjust = -1.45, colour = "black", size=2.8)+
geom_text(aes(label = SElab, y = label_error), position = position_dodge(.9),
vjust = -0.35, colour="black", size=2.5) +
xlab('LU activities') + # for the x axis label
ylab('Area, ha') + scale_y_continuous(labels = comma)
library(survey)
library(tidyverse)
library(knitr)
library(rmarkdown)
library(tidyr)
library(networkD3)
library(tidyverse)
library(dplyr)
library(scales)
library(lubridate)
setwd("C:\\Users\\cryst\\OneDrive\\Documents\\Philippines\\PhilippinesQAQCanalysis")
# area csv
#dataarea_NEW <- read.csv('Results\\AreasofDisturbance_ceoV4version_SAVE_NEW.csv') #R results
dataarea_NEW <- read.csv('Results\\AreasofDisturbance_ceoV4version_SAVE_NEW_OlafssonWay.csv')
dataarea_NEW$phase<-'review'
dataarea_NEW
# area csv
#dataarea_old <- read.csv('Results\\AreasofDisturbance_ceoV4version_SAVE_Old.csv') #R results
dataarea_old <- read.csv('Results\\AreasofDisturbance_ceoV4version_SAVE_OLD_OlafssonWay.csv')
dataarea_old$phase<-'initial'
colnames(dataarea_old)[1]<-"Strata"
dataarea_old
?comma_format()
#type.convert(dataarea_NEW$Area, as.is=TRUE)   ###kinda helped
dataTest <- rbind(dataarea_NEW, dataarea_old)
dataTest$Arealab <- comma_format()(dataTest$Area)
#dataTest$Arealab <- 1
dataTest$SElab <- paste0('+/- ', comma_format()(dataTest$SE))
###above got error: Error in x * scale : non-numeric argument to binary operator
data <- data.frame(dataTest)
#vLABELH <- c(145813,152997,90409,160376,286795,355990,346318)
# Calculate y position, placing it in the middle
####BELOW GETS LOTS OF ERRORS####
data <- data %>%
group_by(Strata) %>%
#mutate(label_y = cumsum(Area) - 0.5 * Area)
mutate(label_y = cumsum(Area) -cumsum(Area))
# Calculate error position, placing it above
data <- data %>%
group_by(Strata) %>%
mutate(label_error = SE+Area)
# Most basic error bar
ggplot(data, aes(fill= phase, x = Strata, y = Area )) +
geom_bar(position="dodge", stat="identity", alpha=1) +
geom_errorbar(aes(ymin = Area - SE, ymax = Area + SE),
width = 0.2, colour = "black",
position = position_dodge(.9)) +
geom_text(aes(label = Arealab, y = label_error), position = position_dodge(.9),
vjust = -1.45, colour = "black", size=2.8)+
geom_text(aes(label = SElab, y = label_error), position = position_dodge(.9),
vjust = -0.35, colour="black", size=2.5) +
xlab('LU activities') + # for the x axis label
ylab('Area, ha') + scale_y_continuous(labels = comma)
